**卫盈联信息技术（深圳）有限公司**

**技术开发中心H5编码规范**

**2019年12月06日**

版本变更记录
  
|版本号|日期|变更说明|编制|审核|批准|
| ----------- | ------------- | ----------------  | ---------- | ---------- | ---------- |
| V1.0   |    2019-12-06 |  新编  |        |           |        |
| V1.1       |    2019-12-09       |   ESLint      |        |           |        |
|        |           |        |        |           |        |

目录

第一章 JavaScript编码规范 3

[1前言 3](\l)

[2代码风格 3](\l)

[3语言特性 5](\l)

[第二章 HTML编码规范 6](\l)

[1前言 6](\l)

[2代码风格 6](\l)

[3 通用 7](\l)

[4 head 8](\l)

[5图片 8](\l)

[6表单 8](\l)

[第三章 CSS编码规范 9](\l)

[1前言 9](\l)

[2代码风格 9](\l)

[3通用 10](\l)

[第四章 实施落地( ESLint ) 11](\l)

[1前言 11](\l)

[2优势 11](\l)

[3如何使用 11](\l)

[4规则定义 12](\l)

第一章 JavaScript编码规范
=========================

1前言
-----

JavaScript 有着广泛的应用，特别是在浏览器端的行为管理。本文档的目标是使
JavaScript 代码风格保持一致，容易被理解和被维护。虽然本章节是针对
JavaScript 设计的，但是在使用各种 JavaScript 的预编译语言时（如
TypeScript 等）时，适用的部分也应尽量遵循本文档的约定。

2代码风格
---------

### 2.1文件

JavaScript 文件使用UTF-8 编码，UTF-8 编码具有更广泛的适应性。

### 2.2缩进

2.2.1使用 2 个空格做为一个缩进层级，使用 Tab 键必须转换成 2 个空格。

2.2.2 switch 下的 case 和 default 必须增加一个缩进层级。

### **2.3空格**

2.3.1二元运算符两侧必须有一个空格，一元运算符与操作对象间不允许有空格。

2.3.2用作代码块起始的左花括号 { 前必须有一个空格。

2.3.3 if / else / for / while / function / switch / do / try / catch /
finally 关键字后，必须有一个空格。

2.3.4在对象创建时，属性中的 : 之后必须有空格，: 之前不允许有空格。

2.3.5函数声明、具名函数表达式、函数调用中，函数名和 ( 之间不允许有空格。

2.3.6行尾不得有多余的空格。

### **2.4换行**

2.4.1每个独立语句结束后必须换行。

2.4.2每行建议不得超过 120 个字符。

解释：

超长不可分割的代码允许例外，比如复杂的正则表达式。长字符串不在例外之列。

2.4.3运算符处换行时，运算符必须在新行的行首。

2.4.4在函数声明、函数表达式、函数调用、对象创建、数组创建、for
语句等场景中，不允许在 , 或 ; 前换行。

### 2.5语句 {#语句-1}

2.5.1不得省略语句结束的分号。

2.5.2函数定义结束不允许添加分号。

### 2.6命名 {#命名-1}

2.6.1函数、变量、参数使用驼峰命名法。

2.6.2类名首字母大写。

2.6.3常量全部字母大写。

### 2.7注释

#### 2.7.1单行注释

必须独占一行。// 后跟一个空格，缩进与下一行被注释说明的代码一致。

#### 2.7.2多行注释

避免使用 /\*\...\*/ 这样的多行注释。有多行注释内容时，使用多个单行注释。

#### 2.7.2文档注释

为了便于代码阅读和自文档化，内容必须包含以 /\*\*\...\*/ 形式的块注释中。

3语言特性
---------

### 3.1变量

变量、函数在使用前必须先定义。变量必须即用即声明，不得在函数或其它形式的代码块起始位置统一声明所有变量

### 3.2条件

在 Equality Expression 中使用类型严格的 ===。仅当判断 null 或 undefined
时，允许使用 == null。

### 3.3字符串

字符串开头和结束使用单引号 \'。

### 3.4 对象

3.4.1使用对象字面量 {} 创建新 Object。

3.4.2对象创建时，如果一个对象的所有属性均可以不添加引号，建议所有属性不添加引号。

3.4.3对象创建时，如果任何一个属性需要添加引号，则所有属性建议添加 \'。

3.4.4不允许修改和扩展任何原生对象和宿主对象的原型。

### 3.5数组

3.5.1使用数组字面量 \[\] 创建新数组，除非想要创建的是指定长度的数组。

3.5.2遍历数组不使用 for in。

3.5.3建议清空数组使用 .length = 0。

### 3.6函数

3.6.1一个函数的长度应控制在 50 行以内。

3.6.2一个函数的参数控制在6个以内。

3.6.3通过 options 参数传递非数据输入型参数。

3.6.4避免使用直接 eval 函数。

解释：

直接 eval，指的是以函数方式调用 eval 的调用方法。直接 eval
调用执行代码的作用域为本地作用域，应当避免。

第二章 HTML编码规范
===================

1前言
-----

HTML 作为描述网页结构的超文本标记语言，有着广泛的应用。本文档的目标是使
HTML 代码风格保持一致，容易被理解和被维护。

2代码风格
---------

### 2.1文件

HTML 文件使用UTF-8 编码，UTF-8 编码具有更广泛的适应性。

### 2.2缩进

使用 2 个空格做为一个缩进层级，使用 Tab 键必须转换成 2 个空格。

### 2.3命名 {#命名-2}

class 必须代表相应模块或部件的内容或功能，不得以样式信息进行命名。元素
id 必须保证页面唯一。

解释：

不允许 class 只用于让 JavaScript 选择某些元素，class
应该具有明确的语义和样式。否则容易导致 CSS class 泛滥。

使用 id、属性选择作为 hook 是更好的方式。

同一页面，应避免使用相同的 name 与 id。

一个比较好的实践是，为 id 和 name 使用不同的命名法。

### 2.4标签

2.4.1标签使用必须符合标签嵌套规则。

解释：

比如 div 不得置于 p 中，tbody 必须置于 table 中。

详细的标签嵌套规则参见HTML DTD中的 Elements 定义部分。

2.4.2 HTML 标签的使用应该遵循标签的语义。

解释：

下面是常见标签语义

p - 段落

h1, h2, h3, h4, h5, h6 - 层级标题

ul - 无序列表

ol - 有序列表

dl, dt, dd - 定义列表

### 2.5属性

2.5.1属性值必须用双引号包围。

2.5.2布尔类型的属性，建议不添加属性值。

示例：

\<input type=\"text\" disabled\>\
\<input type=\"checkbox\" value=\"1\" checked\>

2.5.3自定义属性建议以 xxx- 为前缀，推荐使用 data-。

解释：

使用前缀有助于区分自定义属性和标准定义的属性。

示例：

\<ol data-ui-type=\"select\"\>\</ol\>

3 通用
------

### 3.1 DOCTYPE

使用 HTML5 的 doctype 来启用标准模式，建议使用大写的 DOCTYPE。

### 3.2编码

页面必须使用精简形式，明确指定字符编码，使用 UTF-8 编码。

### 3.3 CSS 和 JavaScript 引入

3.3.1引入 CSS 时必须指明 rel=\"stylesheet\"。

3.3.2引入 CSS 和 JavaScript 时无须指明 type 属性。

3.3.3在 head 中引入页面需要的所有 CSS 资源。

3.3.4 JavaScript 应当放在页面末尾，或采用异步加载。

4 head
------

### 4.1 title

页面必须包含 title 标签声明标题，必须作为 head 的直接子元素。

### 4.2 favicon

4.2.1保证 favicon 可访问。

4.2.2若页面欲对移动设备友好，需指定页面的 viewport 。

5图片
-----

5.1禁止 img 的 src 取值为空。延迟加载的图片也要增加默认的 src。

解释：

src 取值为空，会导致部分浏览器重新加载一次当前页面。

5.2为重要图片添加 alt 属性，以提高图片加载失败时的用户体验。

5.3添加 width 和 height 属性，以避免页面抖动。

6表单
-----

### 6.1控件标题

有文本标题的控件必须使用 label 标签将其与其标题相关联。

示例：

\<label\>\<input type=\"checkbox\" name=\"confirm\" value=\"on\"\>
我已确认上述条款\</label\>\
\<label for=\"username\"\>用户名：\</label\> \<input type=\"textbox\"
name=\"username\" id=\"username\"\>

### 6.2按钮

使用 button 元素时必须指明 type 属性值。

解释：

button 元素的默认 type 为 submit，如果被置于 form
元素中，点击后将导致表单提交。为显示区分其作用方便理解，必须给出 type
属性。

第三章 CSS编码规范
==================

1前言
-----

CSS 作为网页样式的描述语言，有着广泛的应用。本文档的目标是使 CSS
代码风格保持一致，容易被理解和被维护。虽然本单节是针对 CSS
设计的，但是在使用各种 CSS 的预编译器（如 less、sass、stylus
等）时，适用的部分也应尽量遵循本文档的约定。

2代码风格
---------

### 2.1文件

CSS 文件使用UTF-8 编码，UTF-8 编码具有更广泛的适应性。

### 2.2缩进

使用 2 个空格做为一个缩进层级，使用 Tab 键必须转换成 2 个空格。

### 2.3空格

选择器与 { 之间必须包含空格。

属性名与之后的 : 之间不允许包含空格， : 与属性值之间必须包含空格。

列表型属性值书写在单行时，',' 后必须跟一个空格。

### 2.4行长度

每行一般不得超过 120 个字符，除非单行不可分割。

### 2.5选择器

当一个 rule 包含多个 selector 时，每个选择器声明必须独占一行。

\>、+、\~ 选择器的两边各保留一个空格。

属性选择器中的值必须用双引号包围。

### 2.6属性

属性定义必须另起一行。

属性定义后必须以分号结尾。

3通用
-----

### **3.1选择器**

如无必要，不得为 id、class 选择器添加类型选择器进行限定。

建议选择器的嵌套层级应不大于 3 级，位置靠后的限定条件应尽可能精确。

### **3.2属性缩写**

在可以使用缩写的情况下，尽量使用属性缩写。

使用 border / margin / padding
等缩写时，应注意隐含值对实际数值的影响，确实需要设置多个方向的值时才使用缩写。

### **3.3属性缩写**

同一 rule set 下的属性在书写时，应按功能进行分组，并以 Formatting
Model（布局方式、位置） \> Box Model（尺寸） \> Typographic（文本相关）
\> Visual（视觉效果） 的顺序书写，以提高代码的可读性。

**3.4清除浮动**

当元素需要撑起高度以包含内部的浮动元素时，通过对伪类设置 clear 或触发
BFC 的方式进行 clearfix。尽量不使用增加空标签的方式。

**3.5 !important**

尽量不使用 !important 声明。

当需要强制指定样式且不允许覆盖时，通过标签内联和 !important 定义样式。

**3.6 z-index**

将 z-index 进行分层，对文档流外绝对定位元素的视觉层级关系进行管理。

**3.7 单位长度**

单位长度为 0 时须省略单位。 (也只有长度单位可省)

第四章 实施落地( ESLint )
=========================

1前言
-----

ESLint 可以让程序员在编码的过程中发现问题而不是在执行的过程中。ESLint
的初衷是为了让程序员可以创建自己的检测规则。ESLint
的所有规则都被设计成可插入的。ESLint
的默认规则与其他的插件并没有什么区别，规则本身和测试可以依赖于同样的模式。为了便于人们使用，ESLint
内置了一些规则，当然，你可以在使用过程中自定义规则。

2优势
-----

2.1避免低级bug，找出可能发生的语法错误

2.2提示删除多余的代码

2.3确保代码遵循最佳实践

2.4统一团队的代码风格

3安装使用
---------

3.1 安装

npm install -g eslint

3.2 如果你第一次使用 ESLint，你必须使用 --init 命令新建一个配置文件：

eslint \--init

3.3 使用 ESLint 检测任何 JavaScript 文件

eslint test.js test2.js

3.4 ESLint 中一些规则运行命令它可以帮你自动修复

eslint test.js \--fix

4配置规则
---------

4.1 ESlint 是基于规则检测代码的。

-   env：你的脚本将要运行在什么环境中。

-   globals：额外的全局变量。

-   parserOptions：JavaScript 选项。

-   rules：开启规则和发生错误时报告的等级，规则的错误等级有三种

5规则定义
---------

目前在使用的规则是下面这个，兼容了之前的旧代码并且放弃了一部分样式规则。

{

\"extends\": \"airbnb\",

\"env\": {

> \"browser\": true

},

\"rules\": {

> \"import/no-extraneous-dependencies\": \[\"warn\"\],
>
> \"import/no-dynamic-require\": \[\"off\"\],
>
> \"import/no-unresolved\": \"off\",
>
> \"import/extensions\": \"off\",
>
> \"func-names\": \"off\",
>
> \"no-plusplus\": \"off\",
>
> \"global-require\": \"off\",
>
> \"jsx-a11y/no-static-element-interactions\": \"off\",
>
> \"jsx-a11y/no-noninteractive-element-interactions\": \"off\",
>
> \"no-unused-expressions\": \"warn\",
>
> \"react/jsx-no-bind\": \"warn\",
>
> \"class-methods-use-this\": \"off\",
>
> \"react/jsx-filename-extension\": \[\"error\", { \"extensions\":
> \[\".js\", \".jsx\"\] }\],
>
> \"react/no-array-index-key\": \"off\",
>
> \"react/no-find-dom-node\": \"warn\",
>
> \"react/no-string-refs\": \"warn\",
>
> \"max-len\": \"warn\",
>
> \"no-undef\": \"warn\",
>
> \"array-callback-return\": \"off\",
>
> \"no-restricted-syntax\": \"off\",
>
> \"react/require-default-props\": \"off\",
>
> \"react/forbid-prop-types\": \"off\",
>
> \"no-multi-assign\": \"off\",
>
> \"no-useless-constructor\": \"off\",
>
> \"react/prefer-stateless-function\": \"warn\",
>
> \"no-script-url\": \"off\",
>
> \"react/sort-comp\": \"off\",
>
> \"no-param-reassign\": \"off\",
>
> \"consistent-return\": \"off\"

},

\"globals\": {

> \"\$\": true,
>
> \"\$core\": true,
>
> \"API\": true,
>
> \"Utils\": true,
>
> \"WelabAPP\": true,
>
> \"welab\": true

}

}
